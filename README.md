# Night Shift Call Analyzer (Avaya HTML → Streamlit)

Приложение для анализа **ночной смены** по HTML-отчётам Avaya CMS.

## Логика

- Ночная смена: с **18:30** текущего дня до **06:30** следующего.
  - Например: `03.12.2025 18:30 – 04.12.2025 06:30` — одна ночная смена датой **03.12.2025**.
- Учитываются только вызовы в этом интервале.
- Дата смены считается так:
  - если время вызова ≥ 18:30 — относится к дате этого дня,
  - если время вызова < 06:30 — относится к предыдущей дате.

### Типы вызовов

- **Принятые звонки**:
  - `Размещение = ANS`
  - указано поле **«Имена пользователей»** (код оператора).
- **Проспанные звонки оператора (ABAN с оператором)**:
  - `Размещение = ABAN`
  - `Split/Skill` в {`1`, `3`, `9`}:
    - `1` — Надежность
    - `3` — Качество э/э
    - `9` — ЭЗС
  - поле **«Имена пользователей»** не пустое (оператор был привязан).
- **ABAN без оператора**:
  - `Размещение = ABAN`
  - `Split/Skill` в {`1`, `3`, `9`}
  - поле **«Имена пользователей»** пустое.

### Что показывает приложение

Разбивка по **получасовым интервалам** ночной смены:

1. Сколько принял звонков каждый оператор (ANS), с подсветкой зелёным.
2. Сколько у каждого оператора было проспанных звонков (ABAN с оператором, тематики 1/3/9), с подсветкой розовым.
3. Детализация по тематикам (1/3/9) для принятых и проспанных.
4. ABAN по тематикам, где **никто не был привязан** (нет оператора).
5. Отдельно:
   - получасовки, где были только проспанные звонки и ни одного принятого;
   - ситуации **«один оператор работал, пока другой пропускал звонки»**:
     - есть оператор(ы), которые в этом получасе приняли хотя бы один звонок;
     - есть оператор(ы), у кого в этом же получасе были ABAN по 1/3/9 и при этом он не принял ни одного звонка.

Также можно переименовать коды операторов в реальные имена для отчётов.

## Установка и запуск локально

```bash
git clone https://github.com/ВАШ-ЛОГИН/ВАШ-РЕПОЗИТОРИЙ.git
cd ВАШ-РЕПОЗИТОРИЙ

python -m venv venv
source venv/bin/activate  # для Linux/macOS
# venv\Scripts\activate  # для Windows

pip install -r requirements.txt

streamlit run app.py
```

Откроется браузер (обычно `http://localhost:8501`), где:

1. Загрузите HTML-отчёт Avaya.
2. Выберите дату ночной смены.
3. При необходимости подпишите коды операторов удобными именами.
4. Анализируйте принятые и проспанные звонки по получасам.

## Как выложить на GitHub

1. Создайте новый репозиторий на GitHub.
2. В локальной папке проекта выполните:

```bash
git init
git add .
git commit -m "Initial night shift call analyzer"
git branch -M main
git remote add origin https://github.com/ВАШ-ЛОГИН/ВАШ-РЕПОЗИТОРИЙ.git
git push -u origin main
```

После этого код будет доступен на GitHub.
